kind: orbiter.caos.ch/Orb
version: v0
clusters:
  k8s:
    kind: orbiter.caos.ch/KubernetesCluster
    version: v0
    spec:
      controlplane:
        nodes: 1
        pool: masters
        provider: kvm
        updatesdisabled: false
      networking:
        dnsdomain: cluster.orbitertest
        network: calico
        podcidr: 100.127.224.0/20
        servicecidr: 100.126.4.0/22
      versions:
        kubernetes: v1.17.0
        orbiter: v0.15.2
        boom: v0.9.19
      workers:
      - nodes: 1
        pool: workers
        provider: kvm
        updatesdisabled: false
providers:
  kvm:
    kind: orbiter.caos.ch/StaticProvider
    version: v1
    spec:
      pools:
        masters:
        - ip: 192.168.122.61
          id: first
          hostname: master01
        workers:
        - ip: 192.168.122.83
          id: second
          hostname: worker01
    loadbalancing:
      kind: orbiter.caos.ch/DynamicLoadBalancer
      version: v1
      spec:
        masters:
        - ip: 192.168.122.10
          transport:
          - name: kubeapi
            sourceport: 6443
            whitelist: [ 0.0.0.0/0 ]
            destinations:
            - pool: masters
              port: 6443
              healthchecks:
                code: 200
                path: /healthz
                protocol: https
        workers:
        - ip: 192.168.122.11
          whitelist: [ 0.0.0.0/0 ]
          transport:
          - name: httpsingress
            sourceport: 443
            whitelist: [ 0.0.0.0/0 ]
            destinations:
            - healthchecks:
                protocol: https
                path: /ambassador/v0/check_ready
                code: 200
              port: 30443
              pool: workers
          - name: httpingress
            sourceport: 80
            whitelist: [ 0.0.0.0/0 ]
            destinations:
            - healthchecks:
                protocol: http
                path: /ambassador/v0/check_ready
                code: 200
              port: 30080
              pool: workers
